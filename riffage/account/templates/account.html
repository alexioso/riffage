{% extends 'base.html' %}
{% block content %}

    <!-- Page Content -->
    <div class="container" id="vue-div" style="border-radius: 5%; background-color: #EEEEEE; padding: 2em; margin-top: 4em; margin-bottom: 3em">
      <div class="row">
        <div style="display: none">
            <p id="bio">{{ user.profile.bio }}</p> 
        </div>
        <div class="col-lg-8">
            {% csrf_token %}
          <h4 class="mt-5" style="padding-bottom: 2em">Account Settings</h4>
          <p style="">Username: {{ user }}</p>
          <p style="display: inline; margin-right: 2em">Email: {{ user.email }}</p>
          <button type="button" class="btn-sm btn-info" style="display: inline;">Reset Email</button>
        </div>
        <div class="col-md-10" style="margin-top: 3em; margin-bottom: 3em">
          <div class="form-group" >
            {% verbatim %}
            <div class="" v-if="isActive">
              <label for=""><span style="font-weight: bold">About me: </span> 
                Instruments you play, influences, how much you tend to write, etc</label>
                  <textarea class="form-control" rows="5" id="user_bio">{{user_bio}}</textarea>
            </div>
            <div class="" v-if="!isActive">
                <label for=""><span style="font-weight: bold">About me: </span> 
                    <p id="user_bio">{{user_bio}}</p>
            </div>
            <div >
                <i v-on:click="toggleTextArea" class="fa fa-pencil-square-o" 
                                  aria-hidden="true"  style="float: right"></i>
            </div>
            {% endverbatim %}
          </div>
          
          <div class="col-md-12" style="margin-top: 4em">
            <label class="custom-control custom-checkbox">
              {% if user.profile.private_account %}
                 <input type="checkbox" class="custom-control-input" checked="checked">
              {% else %}
                <input type="checkbox" class="custom-control-input">
              {% endif %}
              <span class="custom-control-indicator"></span>
              <span class="custom-control-description" style="font-weight: bold">Private Account?</span>
              <p style="display: inline; margin-left: 3em">Private accounts cannot be viewed by other users and all riffs will be set to "private"</p>
            </label>
          </div>  
      </div>
        <div class="col-md-3">
          <button type="button" class="btn btn-info" style="float: right;">Reset Password</button>
        </div>
        <div class="col-md-8">
            <button v-on:click="saveUserInfo" type="button" class="btn btn-primary" style="float: right;">Save</button>
        </div>
    </div>
    </div>
   

    <!-- /.container -->

    <!-- Bootstrap core JavaScript -->
    <script src="../../static/js/vue.js"></script>
    <script src="../../static/js/jquery-3.2.1.js"></script>
    <script src="../../static/popper/popper.min.js"></script>
    <script src="../../static/bootstrap/js/bootstrap.min.js"></script>

    <!-- Vue.js -->
    <script>
        var app = function() {
            var self = {};
            
            self.toggleTextArea = function() {
                var bio = document.getElementById('user_bio').value
                self.vue.isActive = !self.vue.isActive;
                if(bio != undefined) self.vue.user_bio = bio
            }
            
            self.saveUserInfo = function() {

              $.ajax({

                            type: "POST",
                            url: "/account/update_user_profile",
                            data: {"user_bio": self.vue.user_bio},
                            dataType: 'json',
                            success: function (json) {
                                self.vue.events = json
                                console.log(self.vue.events)
                        }
                    });
            }
            self.vue = new Vue({
                el: "#vue-div",
                //rdelimiters: ['$[', ']'],
                //unsafeDelimiters: ['!{', '}'],
                data: {
                   isActive: false,
                   user_bio: document.getElementById('bio').innerHTML
                },
                methods: {
                    toggleTextArea: self.toggleTextArea,
                    saveUserInfo: self.saveUserInfo
                }
            });
            return self;
        };
        
        var APP = null;
        // This will make everything accessible from the js console;
        // for instance, self.x above would be accessible as APP.x
        jQuery(function(){APP = app();});
   
    </script>
  </body>

</html>
{% endblock %}